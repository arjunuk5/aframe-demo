<html>
   <!-- include A-Frame obviously -->
   <!-- <script src="https://aframe.io/releases/0.6.0/aframe.min.js"></script> -->
   <!-- include ar.js for A-Frame -->
   <!-- <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script> -->
   <!-- <script src="http://supereggbert.github.io/aframe-htmlembed-component/dist/build.js"></script> -->
   <script src="resources/scripts/aframe-v1.4.1.min.js"></script>
   <script src="resources/scripts/aframe-ar.js"></script>
   <script src="resources/scripts/aframe-htmlembed-component.js"></script>
   <script>
      AFRAME.registerComponent("markerhandler", {
         init: function () {
            this.el.sceneEl.addEventListener("markerFound", () => {
               let markerId = this.el?.id;
               //console.log(markerId);

               const marker = document.querySelector("#" + markerId);

               var data1El = document.createElement("a-entity");
               data1El.setAttribute("position", "0 .4 0");
               data1El.setAttribute("rotation", "-20 0 0");
               data1El.setAttribute(
                  "animation",
                  "property: scale; to: 2 2 2; dir: alternate; loop: true"
               );

               var data2El = document.createElement("a-entity");
               data2El.setAttribute("position", "0 .2 0");
               data2El.setAttribute("rotation", "-20 0 0");
               data2El.setAttribute(
                  "animation",
                  "property: scale; to: 2 2 2; dir: alternate; loop: true"
               );

               var data3El = document.createElement("a-entity");
               data3El.setAttribute("position", "0 .6 0");
               data3El.setAttribute("rotation", "-20 0 0");
               data3El.setAttribute(
                  "animation",
                  "property: scale; to: 2 2 2; dir: alternate; loop: true"
               );

               //let apiURL = "http://182.72.154.142:1881/iotapi/sensor-details?id=";
               //apiURL += markerId;
               let apiURL = "https://random-data-api.com/api/v2/appliances";

               fetch(apiURL)
                  .then((response) => response.json())
                  .then((data) => {
                     console.log(data);
                     // let html = `<h3>${data.name}</h3>`;
                     // html += `<ul><li>Temperature: ${data.temp}</li><li>Humidity: ${data.hum}</li><li>Status: ${data.status}</li></ul>`;
                     // let divId = "dv-" + markerId;
                     marker.innerHTML = "";
                     data1El.setAttribute(
                        "text",
                        `color: red; align: center; value: Brand - ${data.brand}; width: 1.5`
                     );
                     marker.appendChild(data1El);

                     data2El.setAttribute(
                        "text",
                        `color: yellow; align: center; value: Equipment - ${data.equipment}; width: 1.5`
                     );
                     marker.appendChild(data2El);

                     data3El.setAttribute(
                        "text",
                        `color: blue; align: center; value: ID - ${data.id}; width: 1.5`
                     );
                     marker.appendChild(data3El);
                  })
                  .catch((error) => {
                     console.log(error);
                     marker.innerHTML = "";
                     data1El.setAttribute(
                        "text",
                        `color: red; align: center; value: Brand - Not available; width: 1.5`
                     );
                     marker.appendChild(data1El);

                     data2El.setAttribute(
                        "text",
                        `color: yellow; align: center; value: Equipment - Not available; width: 1.5`
                     );
                     marker.appendChild(data2El);

                     data3El.setAttribute(
                        "text",
                        `color: blue; align: center; value: ID - Not available; width: 1.5`
                     );
                     marker.appendChild(data3El);
                  });
            });
         },
      });
   </script>
   <body style="margin: 0px; overflow: hidden">
      <a-scene embedded arjs>
         <a-marker markerhandler preset="kanji" id="sensor-st"> </a-marker>
         <a-entity camera></a-entity>
      </a-scene>
   </body>
</html>
